---
title: Update the Ruby agent
contentType: page
template: basicDoc
topics:
  - Agents
  - Ruby agent
  - Installation
japaneseVersion: ''
---

To take full advantage of New Relic's latest features, enhancements, and important security patches, we recommend you update your Ruby agent to the latest version. For additional information about specific agent updates, refer to the [Ruby agent release notes](/docs/release-notes/agent-release-notes/ruby-release-notes).

## Verify your Ruby agent versions

To determine which Ruby agent versions your apps currently use:

1. In New Relic, from the [account dropdown](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#account-dropdown), select **Account settings > Connected agents**.
2. Optional: Sort by **Oldest agent version**.

## Update the agent

To update the Ruby agent:

* Using Bundler: Run this command:

  ```
  bundle update newrelic_rpm
  ```
* Not using Bundler: Run this command:

  ```
  gem update newrelic_rpm
  ```

## Instrument JRuby

For correct instrumentation:

* With JRuby versions 1.7 or higher, use New Relic Ruby agent version [3.6.8.164 to 3.18.1](/docs/releases/ruby).
* With JRuby versions 9 or higher, use New Relic Ruby agent version [3.6.8.164 or higher](/docs/releases/ruby).

Otherwise, if your application has no transactions and you are using JRuby, you will not be able to see your CPU metrics. This was due to a bug in JRuby, where `Process.times` returned wall-clock time instead of elapsed CPU time. That bug was fixed as of New Relicâ€™s Ruby agent 3.6.8.164 and JRuby 1.7.0.

## Ruby agent versions not supported

**End of life notification:** As of January 26, 2015, New Relic will no longer accept data from Ruby agent versions earlier than **3.9.6**.

These agent versions use an out-of-date protocol when communicating with New Relic's data collection services. In addition, many of these versions contain a potential security issue where they may incorrectly send sensitive data to the New Relic collector.

## Update unsupported agent versions

<Callout variant="important">
  If you are updating from an older agent version, including major version jumps, review the following list for changes in functionality.
</Callout>

<Table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        Migration
      </th>

      <th>
        Comments
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td id="migration-5-6">
        From version 5 to 6
      </td>

      <td>
        Release notes: [Ruby agent 6.0.0.351](/docs/release-notes/agent-release-notes/ruby-release-notes/ruby-agent-600351)

        With the addition of the Tracer API for flexible custom instrumentation, several APIs were deprecated. If used, they need to be updated. For more information, see [Ruby custom instrumentation](/docs/agents/ruby-agent/api-guides/ruby-custom-instrumentation).
      </td>
    </tr>

    <tr>
      <td id="migration-4-5">
        From version 4 to 5
      </td>

      <td>
        Release notes: [Ruby agent 5.0.0.342](/docs/release-notes/agent-release-notes/ruby-release-notes/ruby-agent-500342)

        SSL connections to New Relic are now mandatory.
      </td>
    </tr>

    <tr>
      <td id="migration-3-4">
        From version 3 to 4
      </td>

      <td>
        Release notes: [Ruby agent 4.0.0.332](/docs/release-notes/ruby-agent-400332)

        The agent no longer supports Ruby versions prior to 2.0, JRuby 1.7 and earlier, and all versions of Rubinius.
      </td>
    </tr>

    <tr>
      <td id="deprecated-apis">
        Deprecated API calls
      </td>

      <td>
        For a list of deprecated API calls and their replacements, see [Update deprecated API calls](/docs/agents/ruby-agent/troubleshooting/update-deprecated-api-calls).
      </td>
    </tr>
  </tbody>
</Table>
